<div class="bg-white rounded-xl shadow-lg p-6 sm:p-8 h-full">
  <!-- Card Header -->
  <div class="mb-6">
    <h2 class="text-2xl font-semibold text-gray-800 mb-2">Your Appointments</h2>
    <p class="text-gray-600 text-sm">Manage your scheduled appointments</p>
  </div>

  <!-- Loading State with Skeleton Rows -->
  @if (loading) {
    <div class="overflow-x-auto">
      <table class="w-full">
        <!-- Table Header -->
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Date</th>
            <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Time</th>
            <th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Status</th>
            <th class="px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <!-- Skeleton Rows -->
        <tbody>
          @for (i of [1, 2, 3, 4, 5]; track i) {
            <tr class="border-b border-gray-100">
              <td class="px-6 py-4">
                <div class="animate-pulse">
                  <div class="h-4 bg-gray-300 rounded w-24"></div>
                </div>
              </td>
              <td class="px-6 py-4">
                <div class="animate-pulse">
                  <div class="h-4 bg-gray-300 rounded w-20"></div>
                </div>
              </td>
              <td class="px-6 py-4">
                <div class="animate-pulse">
                  <div class="h-6 bg-gray-300 rounded w-20"></div>
                </div>
              </td>
              <td class="px-6 py-4 text-center">
                <div class="animate-pulse inline-block">
                  <div class="h-9 bg-gray-300 rounded-lg w-20"></div>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  } @else {
    <!-- Empty State -->
    @if (dataSource.data.length === 0) {
      <div class="text-center py-12">
        <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
            d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
          </path>
        </svg>
        <p class="text-gray-600 text-lg mb-2">No appointments yet</p>
        <p class="text-gray-500 text-sm">Book your first appointment to get started</p>
      </div>
    } @else {
      <!-- Table -->
      <div class="overflow-x-auto">
        <table mat-table [dataSource]="dataSource" class="w-full">
          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef class="!text-left !font-semibold !text-gray-700"> Date </th>
            <td mat-cell *matCellDef="let element" class="!text-gray-800"> {{element.date}} </td>
          </ng-container>

          <!-- Time Column -->
          <ng-container matColumnDef="time">
            <th mat-header-cell *matHeaderCellDef class="!text-left !font-semibold !text-gray-700"> Time </th>
            <td mat-cell *matCellDef="let element" class="!text-gray-800"> {{element.time}} </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef class="!text-left !font-semibold !text-gray-700"> Status </th>
            <td mat-cell *matCellDef="let element">
              <span [class]="element.status === 'confirmed' ? 'status-confirmed' : 'status-cancelled'">
                {{ element.status | titlecase }}
              </span>
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="!text-center !font-semibold !text-gray-700"> Actions </th>
            <td mat-cell *matCellDef="let element" class="!text-center">
              @if (element.status === 'confirmed') {
                <button 
                  (click)="cancelAppointment(element)"
                  class="bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg transition-colors text-sm font-medium">
                  Cancel
                </button>
              } @else {
                <span class="text-gray-400 text-sm">Cancelled</span>
              }
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns" class="!bg-gray-50"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
              (click)="onRowClick(row)"
              class="hover:!bg-gray-50 transition-colors cursor-pointer"></tr>
        </table>
      </div>

      <!-- Paginator -->
      <div class="mt-4">
        <mat-paginator 
          [pageSizeOptions]="[5, 10, 25]" 
          [pageSize]="5" 
          [length]="dataSource.data.length" 
          showFirstLastButtons 
          aria-label="Select page of appointments">
        </mat-paginator>
      </div>
    }
  }
</div>